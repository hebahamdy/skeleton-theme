{%- style -%}
  .product-container {
    display: flex;
    flex-direction: column;
    gap: 40px;
    padding: 40px 5%;
  }
  
  @media screen and (min-width: 750px) {
    .product-container {
      flex-direction: row; /* Flex-direction: row automatically flips to right-to-left in RTL mode */
    }
    .product__media { flex: 1.2; }
    .product__info { flex: 1; position: sticky; top: 20px; height: fit-content; }
  }

  /* --- GALLERY STYLES --- */
  .product__gallery { display: flex; flex-direction: column; gap: 15px; }
  .product__main-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    background: #f9f9f9;
    aspect-ratio: 1 / 1;
    object-fit: contain;
  }
  .product__thumbs {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding-bottom: 10px;
  }
  .product__thumb-item {
    flex: 0 0 80px;
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 4px;
    overflow: hidden;
    aspect-ratio: 1 / 1;
  }
  .product__thumb-item.active { border-color: {{ section.settings.accent_color }}; }
  .product__thumb-item img { width: 100%; height: 100%; object-fit: cover; }

  /* --- INFO & BUTTON STYLES --- */
  .product__info { text-align: start; }
  .product__price { font-size: 28px; margin: 15px 0; font-weight: bold; color: {{ section.settings.price_color }}; }
  
  .quantity-input {
    display: flex;
    align-items: center;
    border: 1px solid #ddd;
    width: fit-content;
    margin-bottom: 20px;
  }
  .quantity-input input { width: 50px; border: none; text-align: center; padding: 10px; }
  .quantity-btn { padding: 10px 15px; cursor: pointer; background: none; border: none; font-size: 18px; }

  .product-form__buttons { display: flex; flex-direction: column; gap: 10px; }
  .btn-add-to-cart {
    width: 100%;
    padding: 18px;
    background: transparent;
    color: #000;
    border: 1px solid #000;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
  }
  .btn-add-to-cart:hover { background: #f5f5f5; }
  
  /* Styling Shopify's Dynamic Checkout Button */
  .shopify-payment-button__button--unbranded {
    background-color: #000 !important;
    padding: 18px !important;
    border-radius: 4px !important;
  }
{%- endstyle -%}

<section class="product-container">
  <div class="product__media">
    <div class="product__gallery">
      <div class="product__main-image">
        {%- assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media -%}
        <img id="MainProductImage-{{ section.id }}" 
             src="{{ featured_media | image_url: width: 1000 }}" 
             alt="{{ product.title }}" 
             loading="eager">
      </div>

      <div class="product__thumbs">
        {%- for media in product.media -%}
          <div class="product__thumb-item {% if forloop.first %}active{% endif %}" 
               onclick="switchProductImage('{{ media | image_url: width: 1000 }}', this)">
            {{ media | image_url: width: 150 | image_tag: loading: 'lazy' }}
          </div>
        {%- endfor -%}
      </div>
    </div>
  </div>

  <div class="product__info">
    <nav style="font-size: 12px; margin-bottom: 10px; opacity: 0.6;">
      <a href="{{ routes.root_url }}">Home</a> / {{ product.collections.first.title | default: 'Products' }}
    </nav>
    
    <h1>{{ product.title }}</h1>
    
    <div class="product__price">
      {{ product.selected_or_first_available_variant.price | money }}
    </div>

    <div class="product__description" style="margin-bottom: 30px; line-height: 1.6;">
      {{ product.description | truncatewords: 50 }}
    </div>

    {%- form 'product', product, id: 'product-form' -%}
      <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">

      <label for="Quantity-{{ section.id }}" style="display:block; margin-bottom:10px; font-weight:bold;">Quantity</label>
      <div class="quantity-input">
        <button type="button" class="quantity-btn" onclick="this.nextElementSibling.stepDown()">-</button>
        <input type="number" id="Quantity-{{ section.id }}" name="quantity" value="1" min="1">
        <button type="button" class="quantity-btn" onclick="this.previousElementSibling.stepUp()">+</button>
      </div>

      <div class="product-form__buttons">
        <button type="submit" name="add" class="btn-add-to-cart">Add to Cart</button>
        {{ form | payment_button }}
      </div>
    {%- endform -%}
  </div>

  <div class="product__delivery-info">
  {%- if section.settings.info_text_1 != blank -%}
    <div class="delivery-item">
      {%- if section.settings.info_icon_1 != blank -%}
        <img src="{{ section.settings.info_icon_1 | image_url: width: 50 }}" alt="icon 1" loading="lazy">
      {%- else -%}
        <span style="font-size: 20px;">ðŸšš</span>
      {%- endif -%}
      <div class="delivery-text">{{ section.settings.info_text_1 }}</div>
    </div>
  {%- endif -%}

  {%- if section.settings.info_text_2 != blank -%}
    <div class="delivery-item">
      {%- if section.settings.info_icon_2 != blank -%}
        <img src="{{ section.settings.info_icon_2 | image_url: width: 50 }}" alt="icon 2" loading="lazy">
      {%- else -%}
        <span style="font-size: 20px;">ðŸ’³</span>
      {%- endif -%}
      <div class="delivery-text">{{ section.settings.info_text_2 }}</div>
    </div>
  {%- endif -%}
</div>


</section>

<script>
  function switchProductImage(newSrc, element) {
    const mainImg = document.getElementById('MainProductImage-{{ section.id }}');
    mainImg.src = newSrc;
    document.querySelectorAll('.product__thumb-item').forEach(thumb => thumb.classList.remove('active'));
    element.classList.add('active');
  }
</script>

{% schema %}
{
  "name": "Product Main Premium",
  "settings": [
    { "type": "color", "id": "price_color", "label": "Price Color", "default": "#000000" },
    { "type": "color", "id": "accent_color", "label": "Accent Color (Thumb Border)", "default": "#000000" }
  ]
}
{% endschema %}