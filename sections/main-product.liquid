{%- style -%}
  .product__gallery {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .product__main-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    object-fit: contain;
    aspect-ratio: 1 / 1;
    background: #f9f9f9;
  }

  .product__thumbs {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding-bottom: 10px;
    scrollbar-width: thin;
  }

  .product__thumb-item {
    flex: 0 0 80px; /* Small square thumbs */
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 4px;
    overflow: hidden;
    aspect-ratio: 1 / 1;
  }

  .product__thumb-item.active {
    border-color: #000;
  }

  .product__thumb-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Hide scrollbar for clean look */
  .product__thumbs::-webkit-scrollbar { height: 4px; }
  .product__thumbs::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
{%- endstyle -%}

<div class="product__media">
  <div class="product__gallery">
    <div class="product__main-image">
      {%- assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media -%}
      <img id="MainProductImage-{{ section.id }}" 
           src="{{ featured_media | image_url: width: 1000 }}" 
           alt="{{ product.title }}" 
           loading="eager">
    </div>

    <div class="product__thumbs">
      {%- for media in product.media -%}
        <div class="product__thumb-item {% if forloop.first %}active{% endif %}" 
             onclick="switchProductImage('{{ media | image_url: width: 1000 }}', this)">
          {{ media | image_url: width: 150 | image_tag: loading: 'lazy' }}
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

<script>
  function switchProductImage(newSrc, element) {
    // 1. Change the main image source
    const mainImg = document.getElementById('MainProductImage-{{ section.id }}');
    mainImg.src = newSrc;

    // 2. Update active thumbnail styling
    document.querySelectorAll('.product__thumb-item').forEach(thumb => {
      thumb.classList.remove('active');
    });
    element.classList.add('active');
  }
</script>