{%- style -%}
  :root {
    --header-bg: {{ section.settings.bg_color }};
    --header-text: {{ section.settings.text_color }};
  }

  .header-wrapper {
    background-color: var(--header-bg);
    color: var(--header-text);
    padding: 15px 5%;
    display: flex;
    align-items: center;
    position: relative;
    z-index: 100;
    transition: all 0.3s ease;
  }

  .header--sticky { position: sticky; top: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }

  /* Logo Alignment Logic */
  .header--logo-left { justify-content: space-between; }
  .header--logo-center { justify-content: center; flex-direction: column; gap: 15px; }

  .header__logo img { max-width: {{ section.settings.logo_width }}px; height: auto; }
  .header__logo a { color: var(--header-text); text-decoration: none; font-weight: bold; font-size: 24px; }

  /* Navigation */
  .header__inline-menu ul { list-style: none; display: flex; gap: 25px; margin: 0; padding: 0; }
  .header__menu-item { color: var(--header-text); text-decoration: none; font-weight: 500; position: relative; padding: 10px 0; }
  
  /* Dropdown / Mega Menu Animation */
  .has-dropdown { position: relative; }
  .header__submenu {
    position: absolute; top: 100%; left: 0;
    background: white; color: black;
    min-width: 200px; padding: 20px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    opacity: 0; visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
  }
  
  .header--mega-menu .header__submenu {
    width: 90vw; left: 50%; transform: translateX(-50%) translateY(10px);
    display: grid; grid-template-columns: repeat(4, 1fr);
  }

  .has-dropdown:hover .header__submenu {
    opacity: 1; visibility: visible;
    transform: translateY(0) {% if section.settings.menu_type == 'mega' %}translateX(-50%){% endif %};
  }
{%- endstyle -%}

<header class="header-wrapper 
  {% if section.settings.sticky %}header--sticky{% endif %} 
  header--logo-{{ section.settings.logo_position }} 
  {% if section.settings.menu_type == 'mega' %}header--mega-menu{% endif %}">
  
  <div class="header__logo">
    <a href="{{ routes.root_url }}">
      {%- if section.settings.logo != blank -%}
        {{ section.settings.logo | image_url: width: 400 | image_tag: class: 'header__logo-img' }}
      {%- else -%}
        {{ shop.name }}
      {%- endif -%}
    </a>
  </div>

  <nav class="header__inline-menu">
    <ul>
      {%- for link in linklists[section.settings.menu].links -%}
        <li class="{% if link.links != blank %}has-dropdown{% endif %}">
          <a href="{{ link.url }}" class="header__menu-item">{{ link.title }}</a>
          
          {%- if link.links != blank -%}
            <div class="header__submenu">
              {%- for childlink in link.links -%}
                <div class="submenu-column">
                  <a href="{{ childlink.url }}" style="font-weight:bold; display:block; margin-bottom:10px;">{{ childlink.title }}</a>
                  {%- for grandchildlink in childlink.links -%}
                    <a href="{{ grandchildlink.url }}" style="display:block; font-size:14px; margin-bottom:5px; color:#666;">{{ grandchildlink.title }}</a>
                  {%- endfor -%}
                </div>
              {%- endfor -%}
            </div>
          {%- endif -%}
        </li>
      {%- endfor -%}
    </ul>
  </nav>
</header>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo Image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 300,
      "step": 5,
      "unit": "px",
      "label": "Logo Width",
      "default": 150
    },
    {
      "type": "select",
      "id": "logo_position",
      "label": "Logo Position",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" }
      ],
      "default": "left"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "select",
      "id": "menu_type",
      "label": "Menu Style",
      "options": [
        { "value": "simple", "label": "Simple Dropdown" },
        { "value": "mega", "label": "Mega Menu" }
      ],
      "default": "simple"
    },
    {
      "type": "checkbox",
      "id": "sticky",
      "label": "Enable Sticky Header",
      "default": true
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#121212"
    }
  ]
}
{% endschema %}